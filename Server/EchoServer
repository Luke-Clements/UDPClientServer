
import java.net.BindException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.util.Date;
import java.util.Scanner;

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 *
 * @author lukecjm
 */
public class EchoServerServer {
    public static void main( String args[]) throws Exception 
    {
        DatagramSocket dsock;
        byte bytes[] = new byte[256];                                
        DatagramPacket dpack = new DatagramPacket(bytes, bytes.length );
        
        try
        {
            dsock = new DatagramSocket(Integer.parseInt(args[0]));

            while(true) 
            {
                dsock.receive(dpack);

                byte messageBytes[] = dpack.getData();
                int packSize = dpack.getLength();
                String message = new String(messageBytes, 0, packSize);

                System.out.println(message);
                dsock.send(dpack);
            }
        }
        catch(BindException be)
        {
            System.out.println("The selected port is already in use!");
        }
        catch(Exception e)
        {
            System.out.println("Port number invalid");
        }
    } 
}
